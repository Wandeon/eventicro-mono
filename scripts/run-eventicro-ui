#!/usr/bin/env bash
set -euo pipefail
# Load env-first config if present
if [ -f /etc/default/eventicro.env ]; then
  set -a
  . /etc/default/eventicro.env
  set +a
fi

cd /srv/app/ui

if [ -n "${EVENTICRO_NODE_VERSION:-}" ]; then
  NVM_DIR="${NVM_DIR:-$HOME/.nvm}"
  if [ -s "$NVM_DIR/nvm.sh" ]; then
    # shellcheck source=/dev/null
    . "$NVM_DIR/nvm.sh"
    nvm use "$EVENTICRO_NODE_VERSION" >/dev/null
  fi
fi

exec node build/index.js
